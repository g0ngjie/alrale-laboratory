(window.webpackJsonp=window.webpackJsonp||[]).push([["chunk-2eb46ade"],{"0ea0":function(t,e,n){"use strict";n("24b9")},"20e3":function(t,e,n){"use strict";n("4ca2")},"23d9":function(t,e,n){t.exports=n.p+"img/game_over.ae1a338c.png"},"24b9":function(t,e,n){},"266a":function(t,e,n){"use strict";n("8193")},"37aa":function(t,e,n){"use strict";n.r(e);var a=n("1da1"),s=(n("96cf"),n("caad"),n("2532"),n("94f1")),i=n.n(s),r=n("d412"),c=n("ffb2"),o={data:function(){return{count:3,showBtn:!0}},methods:{handlePalyGame:function(){var t=this;this.$emit("beforeBegin"),this.showBtn=!1,Object(c.autoStopInterval)(1e3,3e3,(function(){2<=t.count?--t.count:(t.showBtn=!0,t.$emit("begin"))}))}}},u=(n("20e3"),n("2877")),l=Object(u.a)(o,(function(){var t=this,e=t.$createElement;e=t._self._c||e;return e("div",{staticClass:"boat-count-down-container"},[e("div",{staticClass:"count-down-container"},[e("span",{staticClass:"count"},[t._v(t._s(t.count)+" ")])]),t.showBtn?e("div",{staticClass:"button-container"},[e("img",{attrs:{src:n("da7f")}}),e("div",{staticClass:"btn-title ripple",on:{"~click":function(e){return t.handlePalyGame(e)}}},[t._v("开始游戏")])]):t._e()])}),[],!1,null,"3893fc6c",null).exports,d=(n("ac1f"),n("1276"),n("a434"),n("a15b"),{props:["count"],filters:{fmtCount:function(t){return t=Object(c.prefixZero)(t,4).split(""),t.splice(2,0,"."),t.join("")}},data:function(){return{countValue:2e3}},methods:{startFunc:function(){var t=this;Object(c.autoStopInterval)(10,2e4,(function(){1<=t.countValue?--t.countValue:(t.countValue=0,t.$emit("gameOver"))}))}},created:function(){this.countValue=2e3,this.startFunc()}}),h=(n("828b"),Object(u.a)(d,(function(){var t=this,e=t.$createElement;e=t._self._c||e;return e("div",{staticClass:"boat-game-dash-board-container"},[e("div",{staticClass:"count-down-container"},[e("span",{staticClass:"title"},[t._v("倒计时(秒)")]),e("span",{staticClass:"count-down"},[t._v(t._s(t._f("fmtCount")(t.countValue)))])]),e("div",{staticClass:"count-container"},[e("span",{staticClass:"title"},[t._v("已滑行(米)")]),e("span",{staticClass:"count"},[t._v(t._s(t.count))])])])}),[],!1,null,"43ad873a",null).exports),p=(s=(n("466d"),n("d3b7"),n("5cc6"),n("9a8c"),n("a975"),n("735e"),n("c1ac"),n("d139"),n("3a7b"),n("d5d6"),n("82f8"),n("e91f"),n("60bd"),n("5f96"),n("3280"),n("3fcc"),n("ca91"),n("25a1"),n("cd26"),n("3c5d"),n("2954"),n("649e"),n("219c"),n("170b"),n("b39a"),n("72f7"),n("3ca3"),n("ddb0"),n("2b3d"),n("c0e9")),n.n(s));function v(t,e){var n=document.createElement("a");p()(t).then((function(t){t=document.body.appendChild(t),t.style.display="none",n.style.display="none",document.body.removeChild(t),t=function(t){for(var e=t.split(","),n=(t=e[0].match(/:(.*?);/)[1],atob(e[1])),a=n.length,s=new Uint8Array(a);a--;)s[a]=n.charCodeAt(a);return new Blob([s],{type:t})}(t.toDataURL("image/png")),n.setAttribute("href",URL.createObjectURL(t)),n.setAttribute("download",e+".png"),document.body.appendChild(n),n.click(),URL.revokeObjectURL(t),document.body.removeChild(n)}))}o={props:["distance","times"],data:function(){return{percent:91,info:{avatar:"http://api.g0ngjie.com/assets/avatar.jpg",nickName:"张三",m:200}}},methods:{handleClose:function(){this.$emit("close")},handleOpenRanking:function(){this.$emit("close"),this.$router.push("/boat/rankingList")},handleShare:function(){v(this.$refs.html2canvas,"share")}}},n("266a"),d=Object(u.a)(o,(function(){var t=this,e=t.$createElement;e=t._self._c||e;return e("div",{staticClass:"boat-success-modal-container"},[e("div",{staticClass:"success-modal-container"},[e("div",{staticClass:"success-container"},[e("div",{staticClass:"close-container",on:{click:t.handleClose}}),e("div",{staticClass:"title-container"},[e("span",[t._v("超过了全国")]),e("span",{staticClass:"percent"},[t._v(t._s(t.percent)+"%")]),e("span",[t._v("的长城车主")])]),e("div",{staticClass:"content-container"},[e("span",[t._v("行驶里程："+t._s(t.distance||0)+"M")])]),e("div",{staticClass:"btn-container"},[e("div",{staticClass:"badge"},[t._v(t._s(t.times||0))]),e("div",{staticClass:"repeat-container ripple",on:{click:function(e){return t.$emit("repeat")}}},[t._v("再次游戏")]),e("div",{staticClass:"share ripple",on:{click:t.handleShare}},[t._v("一键分享到社区")]),e("div",{staticClass:"ranking-list ripple",on:{click:t.handleOpenRanking}},[t._v("排行榜")])])])]),e("div",{staticClass:"share-container"},[e("div",{ref:"html2canvas",staticClass:"bg-container",attrs:{id:"html2canvas"}},[e("div",{staticClass:"info-container"},[e("div",{staticClass:"user"},[e("img",{attrs:{src:t.info.avatar}}),e("span",[t._v(t._s(t.info.nickName))])]),e("div",{staticClass:"journey"},[e("span",{staticClass:"title"},[t._v("行驶里程：")]),e("div",{staticClass:"target"},[t._v(t._s(t.info.m))]),e("span",{staticClass:"end"},[t._v("M")])]),e("div",{staticClass:"content"},[e("span",[t._v("超过了全国")]),e("span",{staticClass:"percent"},[t._v(t._s(t.percent)+"%")]),e("span",[t._v("的长城车主")])])])])])])}),[],!1,null,"4d02e5c4",null).exports,s={methods:{handleClose:function(){this.$emit("close")}}},n("47f7"),o=Object(u.a)(s,(function(){var t=this,e=t.$createElement;e=t._self._c||e;return e("div",{staticClass:"boat-use-up-modal-container"},[e("div",{staticClass:"use-up-container"},[e("div",{staticClass:"close-container",on:{click:t.handleClose}}),t._m(0),e("div",{staticClass:"btn-container"},[e("div",{staticClass:"btn ripple",on:{click:t.handleClose}},[t._v("知道了")])])])])}),[function(){var t=this.$createElement;t=this._self._c||t;return t("div",{staticClass:"content-container"},[t("span",[this._v("今日游戏次数已用完")]),t("span",[this._v("请明天再来哦~")])])}],!1,null,"7c8e1c70",null).exports;var f=n("a155"),m=n("b328"),b=(s=n("22e0"),n.n(s));o={extends:r.b,components:{CountDown:l,GameDashboard:h,SuccessModal:d,UseUpModal:o},data:function(){return{times:0,targetBg:null,targetBoat:null,targetDrum:null,throttleId:null,preClickTime:null,count:0,Status:m.d,currentStatus:m.d.STATIC,ModalStatus:m.c,currentModalStatus:null}},computed:{showOptionBtn:function(){var t=m.d.RUNNING,e=m.d.BEFORE_START,n=m.d.WAIT,a=m.c.SUCCESS,s=m.c.OVER;n=![t,e,n].includes(this.currentStatus),s=![a,s].includes(this.currentModalStatus);return n&&s},showGameOverTitle:function(){var t=m.d.WAIT,e=m.c.ENDING,n=this.currentStatus,a=this.currentModalStatus;return n===t||a===e},showCountDown:function(){var t=m.d.STATIC,e=m.d.BEFORE_START,n=m.c.SUCCESS,a=m.c.OVER,s=m.c.ENDING,i=this.currentStatus,r=this.currentModalStatus;i=[t,e].includes(i),r=![n,a,s].includes(r);return i&&r},showGameDashboard:function(){return[m.d.RUNNING,m.d.WAIT].includes(this.currentStatus)},showSuccessModal:function(){return this.currentModalStatus===m.c.SUCCESS},showUseUpModal:function(){return this.currentModalStatus===m.c.OVER}},methods:{handleCloseModal:function(){this.currentStatus=m.d.STATIC,this.currentModalStatus=null},handleEnding:function(){this.currentModalStatus=m.c.ENDING},handleOpenMyBoat:function(){this.$router.push("/boat/storehouse")},handleOpenRanking:function(){this.$router.push("/boat/rankingList")},handleRepeat:function(){this.currentStatus=m.d.STATIC,this.currentModalStatus=null,this.count=0},handleBegin:function(){this.targetBg.play(),this.currentStatus=m.d.RUNNING,--this.times,Object(f.g)(this.times)},handleGameOver:function(){var t=this;return Object(a.a)(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.targetBg.stop(),t.currentStatus=m.d.WAIT,e.next=4,Object(c.sleepSync)(2e3);case 4:t.currentStatus=m.d.GAME_OVER,t.times<=0?t.currentModalStatus=m.c.OVER:t.currentModalStatus=m.c.SUCCESS;case 6:case"end":return e.stop()}}),e)})))()},setAnimation:function(t,e){var n=t.id,a=t.data,s=t.loop;t=t.autoplay,t=void 0===t||t,n=document.getElementById(n);e(i.a.loadAnimation({container:n,renderer:"svg",loop:s,autoplay:t,animationData:a}))},run:function(){var t=this;return Object(a.a)(regeneratorRuntime.mark((function e(){var n,a,s,i;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=Object(f.a)(),e.next=3,t.$store.dispatch("boat/getJSON");case 3:return i=e.sent,a=i.qiaogu,s=i[n],e.next=8,t.$store.dispatch("boat/getBgJSON");case 8:i=e.sent,t.setAnimation({id:"game-bg-id",data:i,autoplay:!1},(function(e){t.targetBg=e})),t.setAnimation({id:"game-boat-id",data:s,autoplay:!1},(function(e){t.targetBoat=e})),t.setAnimation({id:"game-drum-id",data:a,autoplay:!1},(function(e){t.targetDrum=e}));case 12:case"end":return e.stop()}}),e)})))()},throttleFunc:function(){var t=this;this.count+=1,this.targetDrum.play(),this.targetBoat.play();var e=function(t){var e=Date.now();if(t.preClickTime){var n=e-t.preClickTime;return t.preClickTime=e,300<n?1:n<=300&&250<n?1.2:n<=250&&200<n?1.4:n<=200&&150<n?1.7:n<=150&&100<n?2:n<=100&&50<n?2.5:3}return t.preClickTime=e,1}(this);b()().debug("speed => ",e),this.targetDrum.setSpeed(e),this.targetBoat.setSpeed(e),this.throttleId&&(clearTimeout(this.throttleId),this.throttleId=null),this.throttleId=setTimeout((function(){b()().debug("自动停止 => ",380),t.targetDrum.stop(),t.targetBoat.stop()}),380)},handleKnockOn:function(){this.currentStatus===m.d.RUNNING&&this.throttleFunc()}},created:function(){this.times=Object(f.d)(),this.currentStatus=m.d.STATIC,this.times<=0?this.currentModalStatus=m.c.OVER:this.currentModalStatus=null},mounted:function(){this.run()}},n("0ea0"),o=Object(u.a)(o,(function(){var t=this,e=t.$createElement;e=t._self._c||e;return e("div",{staticClass:"boat-game-container"},[t.showOptionBtn?e("div",{staticClass:"option-button-container"},[e("div",{staticClass:"rank-list-btn ripple",on:{click:t.handleOpenRanking}},[e("div",{staticClass:"rank-list-icon"}),e("span",[t._v("排行榜")])]),e("div",{staticClass:"my-boats-btn ripple",on:{click:t.handleOpenMyBoat}},[e("div",{staticClass:"my-boat-icon"}),e("span",[t._v("我的龙舟")])])]):t._e(),t.showGameOverTitle?e("div",{staticClass:"game-over-title"},[e("img",{attrs:{src:n("23d9")}})]):t._e(),t.showCountDown?e("CountDown",{staticClass:"count-down-container",on:{beforeBegin:function(e){t.currentStatus=t.Status.BEFORE_START},begin:t.handleBegin}}):t._e(),t.showGameDashboard?e("GameDashboard",{staticClass:"game-dashboard-container",attrs:{count:t.count},on:{gameOver:t.handleGameOver,"update:count":function(e){t.count=e}}}):t._e(),t.showSuccessModal?e("SuccessModal",{attrs:{distance:t.count,times:t.times},on:{repeat:t.handleRepeat,close:t.handleCloseModal}}):t._e(),t.showUseUpModal?e("UseUpModal",{on:{close:t.handleEnding}}):t._e(),e("div",{attrs:{id:"game-bg-id"}}),t._m(0),e("div",{staticClass:"drum-container"},[e("div",{attrs:{id:"game-drum-id"}}),e("div",{staticClass:"button",on:{click:t.handleKnockOn}})])],1)}),[function(){var t=this.$createElement;t=this._self._c||t;return t("div",{staticClass:"boat-container"},[t("div",{attrs:{id:"game-boat-id"}})])}],!1,null,"4c716e47",null);e.default=o.exports},"47f7":function(t,e,n){"use strict";n("be17")},"4ca2":function(t,e,n){},8193:function(t,e,n){},"828b":function(t,e,n){"use strict";n("93cb")},"93cb":function(t,e,n){},be17:function(t,e,n){},d412:function(t,e,n){"use strict";n.d(e,"b",(function(){return r}));var a=n("1da1"),s=(n("96cf"),n("a4d3"),n("e01a"),n("ffb2")),i=n("d399"),r={methods:{initJSON:function(){this.$store.dispatch("boat/getJSON")}},created:function(){document.title="端午龙舟活动",this.initJSON()}};e.a={methods:{proxyReq:function(t){var e=arguments;return Object(a.a)(regeneratorRuntime.mark((function n(){var a,s,i,r;return regeneratorRuntime.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:for(n.prev=0,a=e.length,s=new Array(1<a?a-1:0),i=1;i<a;i++)s[i-1]=e[i];return n.next=4,t.apply(void 0,s);case 4:return r=n.sent,n.abrupt("return",{ok:!0,data:r});case 8:return n.prev=8,n.t0=n.catch(0),r=n.t0.description,r=r||"数据请求异常",console.log("[error]error-> ",n.t0),console.log("[error]errMsg-> ",r),n.abrupt("return",{ok:!1,errMsg:r});case 15:case"end":return n.stop()}}),n,null,[[0,8]])})))()},catch:function(t){var e=arguments;return Object(a.a)(regeneratorRuntime.mark((function n(){var a,r,c,o,u;return regeneratorRuntime.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:for(n.prev=0,a=e.length,r=new Array(1<a?a-1:0),c=1;c<a;c++)r[c-1]=e[c];return n.next=4,t.apply(void 0,r);case 4:return o=n.sent,n.abrupt("return",{ok:!0,data:o});case 8:return n.prev=8,n.t0=n.catch(0),u=n.t0.description,u=u||"数据请求异常",console.log("[error]error-> ",n.t0),console.log("[error]errMsg-> ",u),Object(i.a)(u),n.next=17,Object(s.sleepSync)(1500);case 17:return n.abrupt("return",{ok:!1,errMsg:u});case 18:case"end":return n.stop()}}),n,null,[[0,8]])})))()}}}},da7f:function(t,e,n){t.exports=n.p+"img/button.ab8d67be.png"}}]);